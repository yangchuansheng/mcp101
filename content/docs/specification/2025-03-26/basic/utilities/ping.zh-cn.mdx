---
title: Ping (心跳检测)
---

<Callout type="info">
**协议修订版本**: 2025-03-26
</Callout>

模型上下文协议 (Model Context Protocol) 提供了一种可选的 Ping (心跳检测) 机制。通信双方均可使用此机制来确认对方是否仍然在线，以及连接是否处于活动状态。

## 概述

Ping 功能通过简单的“请求-响应”模式实现。客户端或服务器均可通过发送 `ping` 请求来发起心跳检测。

## 消息格式

Ping 请求是一个标准的 JSON-RPC 请求，不包含任何参数：

```json
{
  "jsonrpc": "2.0",
  "id": "123",
  "method": "ping"
}
```

## 行为要求

1.  接收方 **必须** 立即响应一个内容为空的响应：

```json
{
  "jsonrpc": "2.0",
  "id": "123",
  "result": {}
}
```

2.  如果在合理的超时时间内未收到响应，发送方 **可以**：
    *   认为连接已失效
    *   终止连接
    *   尝试执行重连流程

## 使用模式

<Mermaid chart={`
sequenceDiagram
    participant 发送方
    participant 接收方

    发送方->>接收方: ping 请求 (发起心跳检测)
    接收方->>发送方: 空响应 (确认在线)
`} />

## 实现注意事项

*   实现方 **应当** 定期发送 Ping 请求以检测连接状态是否正常。
*   Ping 的发送频率 **应当** 是可配置的。
*   超时时间 **应当** 根据具体的网络环境进行适当设置。
*   **应当** 避免过于频繁地发送 Ping 请求，以减少不必要的网络开销。

## 错误处理

*   请求超时 **应当** 被视为连接失败。
*   若连续多次 Ping 请求失败，**可以** 触发连接重置机制。
*   实现方 **应当** 记录 Ping 失败的相关信息，以便于后续的问题排查和诊断。
